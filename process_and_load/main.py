
import process
import load_to_rds
import base64


def lambda_handler(message, context):

    final_records = []
    for rec in message['Records']:

        try:
            base64_encoded_data = rec['dynamodb']['NewImage']['data']['S']

            # Decode the base64 data back to bytes
            byte_data = base64.b64decode(base64_encoded_data)
            format_bytes_data = process._parse_binary_data(byte_data)

            final_records.append(format_bytes_data)
            print()
        except Exception as ex:
            return {
                'status_code': 500,
                'body': 'Error processing bytes',
                'exception_message': ex
            }


    process_message = process.main(final_records)

    response = load_to_rds.load(process_message)
    return response


if __name__ == '__main__':
    # Exchange Type
    # 1(nse_cm) # 2(nse_fo) # 3(bse_cm) # 4(bse_fo) # 5(mcx_fo) # 7(ncx_fo)  # 13(cde_fo)
    event = {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15430062,
        "exchange_timestamp": 1734425835000,
        "last_traded_price": 9227100,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4166,
        "total_buy_quantity": 1337.0,
        "total_sell_quantity": 938.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9226900,
        "closed_price": 9301400
    }
    bt = {'data': 'AgI1MjUyNAAAAAAAAAAAAAAAAAAAAAAAAAAA9YgAAAAAAADU9d0KlAEAABYrAAAAAAAASwAAAAAAAABmKwAAAAAAAHrsgwYAAAAAAAAAAJDUI0EAAAAAErAgQRw+AAAAAAAAFj8AAAAAAACeIAAAAAAAABRGAAAAAAAA'}

    messages = [
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15430062,
        "exchange_timestamp": 1734425835000,
        "last_traded_price": 9227100,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4166,
        "total_buy_quantity": 1337.0,
        "total_sell_quantity": 938.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9226900,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15430063,
        "exchange_timestamp": 1734425835000,
        "last_traded_price": 9416000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 837,
        "total_buy_quantity": 315.0,
        "total_sell_quantity": 213.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9416000,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "518",
        "sequence_number": 15429500,
        "exchange_timestamp": 1734425834000,
        "last_traded_price": 8901700,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 0,
        "average_traded_price": 0,
        "volume_trade_for_the_day": 0,
        "total_buy_quantity": 0.0,
        "total_sell_quantity": 0.0,
        "open_price_of_the_day": 0,
        "high_price_of_the_day": 0,
        "low_price_of_the_day": 0,
        "closed_price": 10000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15430061,
        "exchange_timestamp": 1734425835000,
        "last_traded_price": 9043900,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 5,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 23885,
        "total_buy_quantity": 4330.0,
        "total_sell_quantity": 6424.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15430064,
        "exchange_timestamp": 1734425835000,
        "last_traded_price": 9609000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 157,
        "total_buy_quantity": 80.0,
        "total_sell_quantity": 88.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9609000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15430866,
        "exchange_timestamp": 1734425837000,
        "last_traded_price": 9045000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 23893,
        "total_buy_quantity": 4386.0,
        "total_sell_quantity": 6419.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15430867,
        "exchange_timestamp": 1734425837000,
        "last_traded_price": 9226900,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4167,
        "total_buy_quantity": 1342.0,
        "total_sell_quantity": 931.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9226900,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15430868,
        "exchange_timestamp": 1734425837000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 164,
        "total_buy_quantity": 73.0,
        "total_sell_quantity": 88.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15431603,
        "exchange_timestamp": 1734425838000,
        "last_traded_price": 9043900,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 2,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 23895,
        "total_buy_quantity": 4369.0,
        "total_sell_quantity": 6401.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15431604,
        "exchange_timestamp": 1734425838000,
        "last_traded_price": 9226700,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4169,
        "total_buy_quantity": 1343.0,
        "total_sell_quantity": 929.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9226700,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15431605,
        "exchange_timestamp": 1734425838000,
        "last_traded_price": 9415300,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 838,
        "total_buy_quantity": 315.0,
        "total_sell_quantity": 214.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9415300,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15432355,
        "exchange_timestamp": 1734425839000,
        "last_traded_price": 9043900,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 23899,
        "total_buy_quantity": 4320.0,
        "total_sell_quantity": 6427.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15432356,
        "exchange_timestamp": 1734425839000,
        "last_traded_price": 9226700,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4169,
        "total_buy_quantity": 1343.0,
        "total_sell_quantity": 936.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9226700,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15432357,
        "exchange_timestamp": 1734425839000,
        "last_traded_price": 9414600,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 840,
        "total_buy_quantity": 313.0,
        "total_sell_quantity": 215.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9414600,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15432358,
        "exchange_timestamp": 1734425839000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 164,
        "total_buy_quantity": 73.0,
        "total_sell_quantity": 88.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15433209,
        "exchange_timestamp": 1734425841000,
        "last_traded_price": 9041300,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 23947,
        "total_buy_quantity": 4673.0,
        "total_sell_quantity": 6740.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15433210,
        "exchange_timestamp": 1734425841000,
        "last_traded_price": 9225500,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4178,
        "total_buy_quantity": 1981.0,
        "total_sell_quantity": 1450.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9225000,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15433211,
        "exchange_timestamp": 1734425841000,
        "last_traded_price": 9410000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 845,
        "total_buy_quantity": 741.0,
        "total_sell_quantity": 623.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9410000,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15433212,
        "exchange_timestamp": 1734425841000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 5,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 173,
        "total_buy_quantity": 117.0,
        "total_sell_quantity": 137.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15433903,
        "exchange_timestamp": 1734425842000,
        "last_traded_price": 9042400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 23,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 23979,
        "total_buy_quantity": 4762.0,
        "total_sell_quantity": 6698.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15433904,
        "exchange_timestamp": 1734425842000,
        "last_traded_price": 9225500,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4178,
        "total_buy_quantity": 2011.0,
        "total_sell_quantity": 1412.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9225000,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15433905,
        "exchange_timestamp": 1734425842000,
        "last_traded_price": 9410400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 848,
        "total_buy_quantity": 711.0,
        "total_sell_quantity": 589.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9410000,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15433906,
        "exchange_timestamp": 1734425842000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 175,
        "total_buy_quantity": 115.0,
        "total_sell_quantity": 134.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15434638,
        "exchange_timestamp": 1734425843000,
        "last_traded_price": 9043000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 6,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 24049,
        "total_buy_quantity": 4834.0,
        "total_sell_quantity": 6641.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15434639,
        "exchange_timestamp": 1734425843000,
        "last_traded_price": 9225400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 2,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4182,
        "total_buy_quantity": 2054.0,
        "total_sell_quantity": 1440.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9225000,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15434640,
        "exchange_timestamp": 1734425843000,
        "last_traded_price": 9410400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 848,
        "total_buy_quantity": 711.0,
        "total_sell_quantity": 592.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9410000,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15434641,
        "exchange_timestamp": 1734425843000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 175,
        "total_buy_quantity": 115.0,
        "total_sell_quantity": 134.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15435395,
        "exchange_timestamp": 1734425844000,
        "last_traded_price": 9043300,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 2,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 24055,
        "total_buy_quantity": 4821.0,
        "total_sell_quantity": 6641.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15435396,
        "exchange_timestamp": 1734425844000,
        "last_traded_price": 9225000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 3,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4198,
        "total_buy_quantity": 2043.0,
        "total_sell_quantity": 1444.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9225000,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15435397,
        "exchange_timestamp": 1734425844000,
        "last_traded_price": 9408400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 3,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 853,
        "total_buy_quantity": 740.0,
        "total_sell_quantity": 617.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9408400,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15435398,
        "exchange_timestamp": 1734425844000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 175,
        "total_buy_quantity": 115.0,
        "total_sell_quantity": 136.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15436016,
        "exchange_timestamp": 1734425845000,
        "last_traded_price": 9045000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 24071,
        "total_buy_quantity": 4792.0,
        "total_sell_quantity": 6651.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15436017,
        "exchange_timestamp": 1734425845000,
        "last_traded_price": 9225000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 3,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4198,
        "total_buy_quantity": 2033.0,
        "total_sell_quantity": 1447.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9225000,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15436018,
        "exchange_timestamp": 1734425845000,
        "last_traded_price": 9408400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 3,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 853,
        "total_buy_quantity": 740.0,
        "total_sell_quantity": 617.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9408400,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15436019,
        "exchange_timestamp": 1734425845000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 175,
        "total_buy_quantity": 115.0,
        "total_sell_quantity": 136.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15436710,
        "exchange_timestamp": 1734425846000,
        "last_traded_price": 9044800,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 2,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 24073,
        "total_buy_quantity": 4831.0,
        "total_sell_quantity": 6642.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15436711,
        "exchange_timestamp": 1734425846000,
        "last_traded_price": 9225000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 3,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4198,
        "total_buy_quantity": 2042.0,
        "total_sell_quantity": 1441.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9225000,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15436712,
        "exchange_timestamp": 1734425846000,
        "last_traded_price": 9408400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 3,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 853,
        "total_buy_quantity": 740.0,
        "total_sell_quantity": 617.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9408400,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15436713,
        "exchange_timestamp": 1734425846000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 175,
        "total_buy_quantity": 115.0,
        "total_sell_quantity": 136.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "435357",
        "sequence_number": 15437451,
        "exchange_timestamp": 1734425848000,
        "last_traded_price": 9045000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9087302,
        "volume_trade_for_the_day": 24075,
        "total_buy_quantity": 4861.0,
        "total_sell_quantity": 6641.0,
        "open_price_of_the_day": 9100100,
        "high_price_of_the_day": 9119800,
        "low_price_of_the_day": 9039000,
        "closed_price": 9121600
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "437994",
        "sequence_number": 15437452,
        "exchange_timestamp": 1734425848000,
        "last_traded_price": 9224900,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9268162,
        "volume_trade_for_the_day": 4203,
        "total_buy_quantity": 2055.0,
        "total_sell_quantity": 1444.0,
        "open_price_of_the_day": 9286300,
        "high_price_of_the_day": 9299900,
        "low_price_of_the_day": 9224900,
        "closed_price": 9301400
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "440576",
        "sequence_number": 15437453,
        "exchange_timestamp": 1734425848000,
        "last_traded_price": 9408400,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 3,
        "average_traded_price": 9451383,
        "volume_trade_for_the_day": 853,
        "total_buy_quantity": 740.0,
        "total_sell_quantity": 617.0,
        "open_price_of_the_day": 9468300,
        "high_price_of_the_day": 9482000,
        "low_price_of_the_day": 9408400,
        "closed_price": 9486000
    },
    {
        "subscription_mode": 2,
        "exchange_type": 5,
        "token": "444542",
        "sequence_number": 15437454,
        "exchange_timestamp": 1734425848000,
        "last_traded_price": 9600000,
        "subscription_mode_val": "QUOTE",
        "last_traded_quantity": 1,
        "average_traded_price": 9637260,
        "volume_trade_for_the_day": 175,
        "total_buy_quantity": 115.0,
        "total_sell_quantity": 136.0,
        "open_price_of_the_day": 9663400,
        "high_price_of_the_day": 9666200,
        "low_price_of_the_day": 9600000,
        "closed_price": 9673600
    }
]

    dynamo_record = {'Records': [{'eventID': '1f784074ddc10b2425f59c9766b126de', 'eventName': 'INSERT', 'eventVersion': '1.1', 'eventSource': 'aws:dynamodb', 'awsRegion': 'ap-south-1', 'dynamodb': {'ApproximateCreationDateTime': 1735875951.0, 'Keys': {'timestamp': {'S': '2025-01-03 09:15:50'}}, 'NewImage': {'data': {'S': 'AgI0MjUyMwAAAAAAAAAAAAAAAAAAAAAAAAAAx2ADAAAAAACj9EQqlAEAAEhNBgAAAAAArwAAAAAAAACdTwYAAAAAAEjVAAAAAAAAAAAAACDX50AAAAAAkAXwQH9XBgAAAAAAf1cGAAAAAADgSwYAAAAAAARVBgAAAAAA'}, 'timestamp': {'S': '2025-01-03 09:15:50'}}, 'SequenceNumber': '188300000000017721796529', 'SizeBytes': 224, 'StreamViewType': 'NEW_AND_OLD_IMAGES'}, 'eventSourceARN': 'arn:aws:dynamodb:ap-south-1:924479393196:table/testTable1/stream/2025-01-03T03:24:15.690'}, {'eventID': '0824795a6f1b240b45ba71cbaf8b895d', 'eventName': 'MODIFY', 'eventVersion': '1.1', 'eventSource': 'aws:dynamodb', 'awsRegion': 'ap-south-1', 'dynamodb': {'ApproximateCreationDateTime': 1735875951.0, 'Keys': {'timestamp': {'S': '2025-01-03 09:15:50'}}, 'NewImage': {'data': {'S': 'AgI0MjUyMwAAAAAAAAAAAAAAAAAAAAAAAAAAK2gDAAAAAACw9UQqlAEAAKxNBgAAAAAArwAAAAAAAACWTwYAAAAAAATYAAAAAAAAAAAAAOCk5kAAAAAAAGjwQH9XBgAAAAAAf1cGAAAAAADgSwYAAAAAAARVBgAAAAAA'}, 'timestamp': {'S': '2025-01-03 09:15:50'}}, 'OldImage': {'data': {'S': 'AgI0MjUyMwAAAAAAAAAAAAAAAAAAAAAAAAAAx2ADAAAAAACj9EQqlAEAAEhNBgAAAAAArwAAAAAAAACdTwYAAAAAAEjVAAAAAAAAAAAAACDX50AAAAAAkAXwQH9XBgAAAAAAf1cGAAAAAADgSwYAAAAAAARVBgAAAAAA'}, 'timestamp': {'S': '2025-01-03 09:15:50'}}, 'SequenceNumber': '188400000000017721796557', 'SizeBytes': 420, 'StreamViewType': 'NEW_AND_OLD_IMAGES'}, 'eventSourceARN': 'arn:aws:dynamodb:ap-south-1:924479393196:table/testTable1/stream/2025-01-03T03:24:15.690'}, {'eventID': '56408eab33d5ccb07464caebe5c04b9b', 'eventName': 'MODIFY', 'eventVersion': '1.1', 'eventSource': 'aws:dynamodb', 'awsRegion': 'ap-south-1', 'dynamodb': {'ApproximateCreationDateTime': 1735875951.0, 'Keys': {'timestamp': {'S': '2025-01-03 09:15:50'}}, 'NewImage': {'data': {'S': 'AgI0MjUyMwAAAAAAAAAAAAAAAAAAAAAAAAAALWgDAAAAAAAI90QqlAEAAKxNBgAAAAAArwAAAAAAAACWTwYAAAAAAATYAAAAAAAAAAAAAOCk5kAAAAAAAGjwQH9XBgAAAAAAf1cGAAAAAADgSwYAAAAAAARVBgAAAAAA'}, 'timestamp': {'S': '2025-01-03 09:15:50'}}, 'OldImage': {'data': {'S': 'AgI0MjUyMwAAAAAAAAAAAAAAAAAAAAAAAAAAK2gDAAAAAACw9UQqlAEAAKxNBgAAAAAArwAAAAAAAACWTwYAAAAAAATYAAAAAAAAAAAAAOCk5kAAAAAAAGjwQH9XBgAAAAAAf1cGAAAAAADgSwYAAAAAAARVBgAAAAAA'}, 'timestamp': {'S': '2025-01-03 09:15:50'}}, 'SequenceNumber': '188500000000017721796597', 'SizeBytes': 420, 'StreamViewType': 'NEW_AND_OLD_IMAGES'}, 'eventSourceARN': 'arn:aws:dynamodb:ap-south-1:924479393196:table/testTable1/stream/2025-01-03T03:24:15.690'}]}

    lambda_handler(dynamo_record, {})
